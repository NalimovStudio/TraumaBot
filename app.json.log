{"asctime": "2025-08-16 02:09:10,863", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:09:10,918", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:09:52,258", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223197 is handled. Duration 16 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:09:57,823", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223198 is handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:09:58,258", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223199 is handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:10:02,068", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223200 is handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:10:09,953", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223201 is handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:10:11,009", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223202 is handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:10:49,047", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:10:49,048", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:10:49,048", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:10:49,236", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:10:55,411", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:10:55,449", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:10:56,890", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223203 is handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:10:58,477", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223204 is handled. Duration 14 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:11:10,634", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223205 is handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:11:46,817", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:11:46,818", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:11:46,819", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:11:46,986", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:11:52,033", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:11:52,081", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:11:56,871", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:11:56,872", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1257313065 started the bot."}
{"asctime": "2025-08-16 02:11:56,873", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223206 is handled. Duration 313 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:11:56,876", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223207 is handled. Duration 234 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:00,418", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223208 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:01,257", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 5340001617 started the bot."}
{"asctime": "2025-08-16 02:12:01,258", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223209 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:02,893", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223211 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:02,893", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223210 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:04,429", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223212 is handled. Duration 140 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:06,124", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223213 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:07,873", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: 'fasdf...'"}
{"asctime": "2025-08-16 02:12:07,874", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:12:07,951", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223214 is handled. Duration 94 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:13,331", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:12:13,458", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223215 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:16,920", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223216 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:17,081", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223217 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:18,750", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223218 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:23,858", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223219 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:12:25,052", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223220 is handled. Duration 344 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:26,374", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:13:26,376", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:13:26,376", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:13:26,541", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:13:31,818", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:13:31,868", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:13:35,506", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:13:35,508", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223221 is handled. Duration 313 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:35,546", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223222 is handled. Duration 155 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:36,578", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223223 is handled. Duration 61 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:37,217", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223224 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:37,904", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: '\u0432\u044b\u0432...'"}
{"asctime": "2025-08-16 02:13:37,905", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:13:37,978", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223225 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:39,043", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223226 is not handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:39,654", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:13:39,892", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223227 is handled. Duration 234 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:40,033", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223228 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:40,317", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1257313065 started the bot."}
{"asctime": "2025-08-16 02:13:40,319", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223229 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:41,134", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223230 is not handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:41,594", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223231 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:41,775", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223232 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:42,576", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223233 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:43,076", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223234 is handled. Duration 219 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:43,160", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 5340001617 started the bot."}
{"asctime": "2025-08-16 02:13:43,161", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223235 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:45,304", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223236 is handled. Duration 63 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:46,249", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223237 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:13:47,616", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223238 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:28,519", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:14:28,520", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:14:28,520", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:14:28,707", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:14:40,337", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:14:40,387", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:14:41,963", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223240 is not handled. Duration 110 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:43,397", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:14:43,400", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223241 is handled. Duration 186 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:43,542", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1257313065 started the bot."}
{"asctime": "2025-08-16 02:14:43,543", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223242 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:44,418", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223243 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:45,076", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223244 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:46,038", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223245 is handled. Duration 61 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:46,041", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223246 is not handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:47,744", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: '\u0431\u0440\u0443\u0442\u0430\u043b...'"}
{"asctime": "2025-08-16 02:14:47,744", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:14:47,815", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223247 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:49,992", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223248 is not handled. Duration 16 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:50,278", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:14:50,403", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223249 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:52,037", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0432\u0432...'"}
{"asctime": "2025-08-16 02:14:52,045", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223250 is handled. Duration 219 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:52,053", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223251 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:52,395", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223252 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:54,851", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 5340001617 started the bot."}
{"asctime": "2025-08-16 02:14:54,853", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223253 is handled. Duration 92 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:56,248", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223254 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:57,058", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223255 is not handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:14:58,548", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223256 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:02,586", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223257 is not handled. Duration 16 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:03,545", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223258 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:04,141", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223259 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:05,528", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223260 is not handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:05,639", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223261 is not handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:07,284", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:15:07,286", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223262 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:12,873", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 5340001617 started the bot."}
{"asctime": "2025-08-16 02:15:12,875", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223263 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:13,654", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223264 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:15,134", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:15:15,136", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223265 is handled. Duration 109 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:16,218", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223266 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:17,353", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223267 is not handled. Duration 14 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:20,571", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:15:20,572", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223268 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:22,070", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223269 is handled. Duration 140 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:39,935", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223270 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:42,096", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1257313065 in CHECK_IN. Msg: '=31\u0451...'"}
{"asctime": "2025-08-16 02:15:42,096", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1257313065. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:15:42,165", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223271 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:43,681", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:15:43,682", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223272 is handled. Duration 140 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:45,197", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.problem_solving", "message": "User 1257313065 chose 'problem' method."}
{"asctime": "2025-08-16 02:15:45,319", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223273 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:46,410", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:15:46,411", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223274 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:47,529", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223275 is handled. Duration 94 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:49,080", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: '\u0432\u0430\u0444\u0444\u044b\u0432\u0430\u043f...'"}
{"asctime": "2025-08-16 02:15:49,080", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:15:49,152", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223276 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:51,709", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223277 is handled. Duration 61 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:58,550", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:15:58,676", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223278 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:15:59,692", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 5340001617 in CHECK_IN. Msg: '\u0425\u043e\u0440\u043e\u0448\u043e...'"}
{"asctime": "2025-08-16 02:15:59,692", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 5340001617. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:15:59,768", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223279 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:16:00,011", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0430\u043f\u043f...'"}
{"asctime": "2025-08-16 02:16:00,013", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223280 is handled. Duration 203 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:16:06,052", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u043f\u0440\u0438\u0432\u0435\u0442...'"}
{"asctime": "2025-08-16 02:16:06,054", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223281 is handled. Duration 188 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:16:21,886", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223282 is handled. Duration 94 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:16:22,051", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.problem_solving", "message": "User 5340001617 chose 'problem' method."}
{"asctime": "2025-08-16 02:16:22,175", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223283 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:16:28,526", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223284 is handled. Duration 328 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:16:35,225", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223285 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:16:47,231", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223286 is handled. Duration 264 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:18:14,616", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:18:14,617", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:18:14,617", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:18:14,824", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:18:32,133", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:18:32,178", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:18:33,806", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:18:33,808", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223287 is handled. Duration 390 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:18:34,803", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223288 is handled. Duration 63 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:18:36,109", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: '\u0432...'"}
{"asctime": "2025-08-16 02:18:36,109", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:18:36,227", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223289 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:18:37,573", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:18:37,680", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223290 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:18:38,473", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0432...'"}
{"asctime": "2025-08-16 02:18:38,474", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223291 is handled. Duration 203 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:18:39,267", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223292 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:18:44,792", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1257313065 started the bot."}
{"asctime": "2025-08-16 02:18:44,794", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223293 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:18:48,047", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0444\u0430\u044b\u0430\u0432\u0430\u0432\u0430...'"}
{"asctime": "2025-08-16 02:18:48,048", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223294 is handled. Duration 188 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:19:27,672", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223295 is handled. Duration 63 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:19:27,777", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:19:27,778", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223296 is handled. Duration 94 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:28:29,777", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:28:29,821", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:28:36,381", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223302 is not handled. Duration 4062 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:28:36,382", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223302 by bot id=8376806252\nConnectionError: Error 22 connecting to localhost:6379. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435.", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 305, in connect_check_health\n    await self.retry.call_with_retry(\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\retry.py\", line 50, in call_with_retry\n    return await do()\n           ^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 760, in _connect\n    reader, writer = await asyncio.open_connection(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\streams.py\", line 48, in open_connection\n    transport, _ = await loop.create_connection(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1126, in create_connection\n    raise exceptions[0]\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\proactor_events.py\", line 729, in sock_connect\n    return await self._proactor.connect(sock, address)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 803, in _poll\n    value = callback(transferred, key, ov)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 599, in finish_connect\n    ov.getresult()\nConnectionRefusedError: [WinError 1225] \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 40, in __call__\n    async with self.events_isolation.lock(key=context.key):\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\storage\\redis.py\", line 171, in lock\n    async with self.redis.lock(name=redis_key, **self.lock_kwargs, lock_class=Lock):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 171, in __aenter__\n    if await self.acquire():\n       ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 224, in acquire\n    if await self.do_acquire(token):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 240, in do_acquire\n    if await self.redis.set(self.name, token, nx=True, px=timeout):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\client.py\", line 672, in execute_command\n    conn = self.connection or await pool.get_connection()\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 1149, in get_connection\n    await self.ensure_connection(connection)\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 1182, in ensure_connection\n    await connection.connect()\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 296, in connect\n    await self.connect_check_health(check_health=True)\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 315, in connect_check_health\n    raise ConnectionError(self._error_message(e))\nredis.exceptions.ConnectionError: Error 22 connecting to localhost:6379. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435."}
{"asctime": "2025-08-16 02:28:40,475", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223303 is not handled. Duration 7547 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:28:40,475", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223303 by bot id=8376806252\nConnectionError: Error 22 connecting to localhost:6379. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435.", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 305, in connect_check_health\n    await self.retry.call_with_retry(\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\retry.py\", line 50, in call_with_retry\n    return await do()\n           ^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 760, in _connect\n    reader, writer = await asyncio.open_connection(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\streams.py\", line 48, in open_connection\n    transport, _ = await loop.create_connection(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1126, in create_connection\n    raise exceptions[0]\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\proactor_events.py\", line 729, in sock_connect\n    return await self._proactor.connect(sock, address)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 803, in _poll\n    value = callback(transferred, key, ov)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 599, in finish_connect\n    ov.getresult()\nConnectionRefusedError: [WinError 1225] \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 40, in __call__\n    async with self.events_isolation.lock(key=context.key):\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\storage\\redis.py\", line 171, in lock\n    async with self.redis.lock(name=redis_key, **self.lock_kwargs, lock_class=Lock):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 171, in __aenter__\n    if await self.acquire():\n       ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 224, in acquire\n    if await self.do_acquire(token):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 240, in do_acquire\n    if await self.redis.set(self.name, token, nx=True, px=timeout):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\client.py\", line 672, in execute_command\n    conn = self.connection or await pool.get_connection()\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 1149, in get_connection\n    await self.ensure_connection(connection)\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 1182, in ensure_connection\n    await connection.connect()\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 296, in connect\n    await self.connect_check_health(check_health=True)\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 315, in connect_check_health\n    raise ConnectionError(self._error_message(e))\nredis.exceptions.ConnectionError: Error 22 connecting to localhost:6379. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435."}
{"asctime": "2025-08-16 02:28:43,023", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:28:43,024", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:28:43,024", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:28:43,231", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:29:05,381", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:29:05,420", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:29:08,488", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:29:08,490", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223304 is handled. Duration 280 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:29:09,790", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223305 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:29:11,784", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: 'l...'"}
{"asctime": "2025-08-16 02:29:11,784", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:29:11,841", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223306 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:29:18,884", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:29:18,984", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223307 is handled. Duration 108 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:29:25,250", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u043f\u043b\u043e\u0445\u043e \u0432\u0441\u0451...'"}
{"asctime": "2025-08-16 02:29:25,251", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223308 is handled. Duration 234 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:30:41,045", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:30:41,047", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:30:41,047", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:30:41,233", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:30:45,855", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:30:45,910", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:30:46,955", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:30:46,957", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223309 is handled. Duration 265 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:30:48,480", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223310 is handled. Duration 187 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:30:50,044", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: 'dd...'"}
{"asctime": "2025-08-16 02:30:50,045", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:30:50,110", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223311 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:30:51,078", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:30:51,212", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223312 is handled. Duration 140 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:30:53,431", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0430\u0432\u0441\u0432\u0445\u0441\u0445...'"}
{"asctime": "2025-08-16 02:30:53,432", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223313 is handled. Duration 218 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:32:10,046", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:32:10,047", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:32:10,048", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:32:10,233", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:32:14,988", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:32:15,025", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:32:15,338", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:32:15,339", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223314 is handled. Duration 235 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:32:16,218", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223315 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:32:17,768", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: 'dd...'"}
{"asctime": "2025-08-16 02:32:17,769", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:32:17,825", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223316 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:32:18,802", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:32:18,898", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223317 is handled. Duration 109 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:32:19,884", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0432\u044b\u0432...'"}
{"asctime": "2025-08-16 02:32:20,059", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0432\u044b\u0432...'"}
{"asctime": "2025-08-16 02:32:20,060", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223318 is not handled. Duration 375 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:32:20,061", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223318 by bot id=8376806252\nTypeError: 'int' object is not callable", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 33, in get_response\n    response = self.client.chat.completions.create(\n               ^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'chat'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 35, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\venting.py\", line 45, in handle_venting_message\n    response_text = await assistant.get_speak_out_response(message=message.text)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\application\\ai_assistant\\ai_assistant_service.py\", line 55, in get_speak_out_response\n    return await self.client.get_response(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 40, in get_response\n    logging.ERROR(\"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a DeepseekAPI\")\nTypeError: 'int' object is not callable\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 33, in get_response\n    response = self.client.chat.completions.create(\n               ^^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'chat'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 42, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 39, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\venting.py\", line 45, in handle_venting_message\n    response_text = await assistant.get_speak_out_response(message=message.text)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\application\\ai_assistant\\ai_assistant_service.py\", line 55, in get_speak_out_response\n    return await self.client.get_response(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 40, in get_response\n    logging.ERROR(\"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a DeepseekAPI\")\nTypeError: 'int' object is not callable"}
{"asctime": "2025-08-16 02:35:16,077", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:35:16,079", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:35:16,079", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:35:16,243", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:35:21,771", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:35:21,823", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:35:23,097", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:35:23,099", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223319 is handled. Duration 250 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:35:24,491", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223320 is handled. Duration 94 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:35:28,811", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: '\u043f\u043e\u0448\u0435\u043b \u043d\u0430\u0445\u0443\u0439...'"}
{"asctime": "2025-08-16 02:35:28,812", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:35:28,901", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223321 is handled. Duration 93 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:35:30,179", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:35:30,302", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223322 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:35:36,947", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0448\u0435\u043b...'"}
{"asctime": "2025-08-16 02:35:37,446", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-0e0ffe8b-6f72-42c7-9312-383fc77da6db', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0421 \u0442\u043e\u0431\u043e\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0443 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e.\\n    \u0427\u0435\u043b\u043e\u0432\u0435\u043a \u0445\u043e\u0447\u0435\u0442 \u0432\u044b\u0441\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f \u0442\u0435\u0431\u0435 \u0438 \u0442\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0435\u0433\u043e \u0432\u044b\u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0438 \u0434\u0430\u0442\u044c \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0432\u044b\u0441\u043e\u043a\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430 \u0438 \u043f\u043e\u0439\u043c\u0438 \u0435\u0433\u043e \u0441\u043b\u0430\u0431\u044b\u0435 \u0438 \u0441\u0438\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u043e\u0440\u043e\u043d\u044b\\n    3. \u0418\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043f\u043e\u0434\u0431\u043e\u0434\u0440\u0438 \u0435\u0433\u043e\\n    '}, {'role': 'user', 'content': '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0448\u0435\u043b'}], 'model': 'deepseek-chat', 'response_format': {'type': 'json_object'}, 'temperature': 0.7}}"}
{"asctime": "2025-08-16 02:35:37,467", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:35:37,468", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:35:37,491", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000018014B4F230>"}
{"asctime": "2025-08-16 02:35:37,491", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x00000180147FC650> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:35:37,513", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000018014C18650>"}
{"asctime": "2025-08-16 02:35:37,513", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:35:37,514", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:35:37,514", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:35:37,514", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:35:37,515", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:35:37,778", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 400, b'Bad Request', [(b'Date', b'Fri, 15 Aug 2025 23:35:39 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'195'), (b'Connection', b'keep-alive'), (b'CF-RAY', b'96fc8278ff6a0178-WAW'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'c33c62234b978f66a8a4127f61c95a02'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=JNWxtF3J9BQAwKqfDiC_uOahxUp8kI2FkVuwZJQPm50-1755300939-1.0.1.1-4Yeo80ePQUZiktNqSsD2Ex0hQcIXFSiYBXut87xgrz_QCXozP5Tyt6udqjG.KiWrfYotCQ8N_NAMqYPYyj4wmqqfqNOnIO5dwtWbllbW.ow; path=/; expires=Sat, 16-Aug-25 00:05:39 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare')])"}
{"asctime": "2025-08-16 02:35:37,779", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 400 Bad Request\""}
{"asctime": "2025-08-16 02:35:37,779", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:35:37,779", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:35:37,780", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:35:37,780", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:35:37,780", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"400 Bad Request\" Headers({'date': 'Fri, 15 Aug 2025 23:35:39 GMT', 'content-type': 'application/json', 'content-length': '195', 'connection': 'keep-alive', 'cf-ray': '96fc8278ff6a0178-WAW', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': 'c33c62234b978f66a8a4127f61c95a02', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=JNWxtF3J9BQAwKqfDiC_uOahxUp8kI2FkVuwZJQPm50-1755300939-1.0.1.1-4Yeo80ePQUZiktNqSsD2Ex0hQcIXFSiYBXut87xgrz_QCXozP5Tyt6udqjG.KiWrfYotCQ8N_NAMqYPYyj4wmqqfqNOnIO5dwtWbllbW.ow; path=/; expires=Sat, 16-Aug-25 00:05:39 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare'})"}
{"asctime": "2025-08-16 02:35:37,781", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:35:37,781", "levelname": "DEBUG", "name": "openai._base_client", "message": "Encountered httpx.HTTPStatusError", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\_base_client.py\", line 1027, in request\n    response.raise_for_status()\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\httpx\\_models.py\", line 829, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.deepseek.com/chat/completions'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"}
{"asctime": "2025-08-16 02:35:37,782", "levelname": "DEBUG", "name": "openai._base_client", "message": "Not retrying"}
{"asctime": "2025-08-16 02:35:37,783", "levelname": "DEBUG", "name": "openai._base_client", "message": "Re-raising status error"}
{"asctime": "2025-08-16 02:35:37,968", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0448\u0435\u043b...'"}
{"asctime": "2025-08-16 02:35:37,969", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-7c48f8bb-36b7-4166-b3f3-88a8579eceb3', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0421 \u0442\u043e\u0431\u043e\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0443 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e.\\n    \u0427\u0435\u043b\u043e\u0432\u0435\u043a \u0445\u043e\u0447\u0435\u0442 \u0432\u044b\u0441\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f \u0442\u0435\u0431\u0435 \u0438 \u0442\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0435\u0433\u043e \u0432\u044b\u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0438 \u0434\u0430\u0442\u044c \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0432\u044b\u0441\u043e\u043a\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430 \u0438 \u043f\u043e\u0439\u043c\u0438 \u0435\u0433\u043e \u0441\u043b\u0430\u0431\u044b\u0435 \u0438 \u0441\u0438\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u043e\u0440\u043e\u043d\u044b\\n    3. \u0418\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043f\u043e\u0434\u0431\u043e\u0434\u0440\u0438 \u0435\u0433\u043e\\n    '}, {'role': 'user', 'content': '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0448\u0435\u043b'}], 'model': 'deepseek-chat', 'response_format': {'type': 'json_object'}, 'temperature': 0.7}}"}
{"asctime": "2025-08-16 02:35:37,970", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:35:37,971", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:35:37,984", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000018014BD43B0>"}
{"asctime": "2025-08-16 02:35:37,985", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x0000018014CE6B50> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:35:38,003", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000018014BA37D0>"}
{"asctime": "2025-08-16 02:35:38,003", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:35:38,004", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:35:38,004", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:35:38,004", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:35:38,004", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:35:38,275", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 400, b'Bad Request', [(b'Date', b'Fri, 15 Aug 2025 23:35:40 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'195'), (b'Connection', b'keep-alive'), (b'CF-RAY', b'96fc827c0966c047-WAW'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'accd769392b075779bf49cb3780ccff9'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=P3Lus4yAfi2.LZr2rxVCRBdCFQisEF2MNwmQU1JvVk0-1755300940-1.0.1.1-CzbswenRq6JmflM0WzPEcKJUg7SLcH11JMQ7n7szhhWRMijcUpNHyCCmTWZXkWWE4F_vXj5ZHhyPWAlUhhwYw1LlsKi32dml3Fii3aefXLM; path=/; expires=Sat, 16-Aug-25 00:05:40 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare')])"}
{"asctime": "2025-08-16 02:35:38,276", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 400 Bad Request\""}
{"asctime": "2025-08-16 02:35:38,276", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:35:38,277", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:35:38,277", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:35:38,277", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:35:38,277", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"400 Bad Request\" Headers({'date': 'Fri, 15 Aug 2025 23:35:40 GMT', 'content-type': 'application/json', 'content-length': '195', 'connection': 'keep-alive', 'cf-ray': '96fc827c0966c047-WAW', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': 'accd769392b075779bf49cb3780ccff9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=P3Lus4yAfi2.LZr2rxVCRBdCFQisEF2MNwmQU1JvVk0-1755300940-1.0.1.1-CzbswenRq6JmflM0WzPEcKJUg7SLcH11JMQ7n7szhhWRMijcUpNHyCCmTWZXkWWE4F_vXj5ZHhyPWAlUhhwYw1LlsKi32dml3Fii3aefXLM; path=/; expires=Sat, 16-Aug-25 00:05:40 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare'})"}
{"asctime": "2025-08-16 02:35:38,278", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:35:38,278", "levelname": "DEBUG", "name": "openai._base_client", "message": "Encountered httpx.HTTPStatusError", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 33, in get_response\n    response = self.client.chat.completions.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\_utils\\_utils.py\", line 287, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\resources\\chat\\completions\\completions.py\", line 1150, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\_base_client.py\", line 1259, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\_base_client.py\", line 1047, in request\n    raise self._make_status_error_from_response(err.response) from None\nopenai.BadRequestError: Error code: 400 - {'error': {'message': \"Prompt must contain the word 'json' in some form to use 'response_format' of type 'json_object'.\", 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_request_error'}}\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 34, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\venting.py\", line 45, in handle_venting_message\n    response_text = await assistant.get_speak_out_response(message=message.text)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\application\\ai_assistant\\ai_assistant_service.py\", line 55, in get_speak_out_response\n    return await self.client.get_response(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 40, in get_response\n    logging.ERROR(\"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a DeepseekAPI\")\nTypeError: 'int' object is not callable\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\_base_client.py\", line 1027, in request\n    response.raise_for_status()\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\httpx\\_models.py\", line 829, in raise_for_status\n    raise HTTPStatusError(message, request=request, response=self)\nhttpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.deepseek.com/chat/completions'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"}
{"asctime": "2025-08-16 02:35:38,285", "levelname": "DEBUG", "name": "openai._base_client", "message": "Not retrying"}
{"asctime": "2025-08-16 02:35:38,286", "levelname": "DEBUG", "name": "openai._base_client", "message": "Re-raising status error"}
{"asctime": "2025-08-16 02:35:38,287", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223323 is not handled. Duration 1530 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:35:38,287", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223323 by bot id=8376806252\nTypeError: 'int' object is not callable", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 33, in get_response\n    response = self.client.chat.completions.create(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\_utils\\_utils.py\", line 287, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\resources\\chat\\completions\\completions.py\", line 1150, in create\n    return self._post(\n           ^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\_base_client.py\", line 1259, in post\n    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\openai\\_base_client.py\", line 1047, in request\n    raise self._make_status_error_from_response(err.response) from None\nopenai.BadRequestError: Error code: 400 - {'error': {'message': \"Prompt must contain the word 'json' in some form to use 'response_format' of type 'json_object'.\", 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_request_error'}}\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 42, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 37, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\venting.py\", line 45, in handle_venting_message\n    response_text = await assistant.get_speak_out_response(message=message.text)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\application\\ai_assistant\\ai_assistant_service.py\", line 55, in get_speak_out_response\n    return await self.client.get_response(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 40, in get_response\n    logging.ERROR(\"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a DeepseekAPI\")\nTypeError: 'int' object is not callable"}
{"asctime": "2025-08-16 02:36:54,824", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 02:36:54,824", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 02:36:54,831", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223324 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:42:40,395", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:42:40,396", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:42:40,396", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:42:40,603", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:42:40,681", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 02:42:40,682", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 02:42:47,963", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:42:48,007", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:42:54,770", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:42:54,771", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223325 is handled. Duration 250 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:42:55,607", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223326 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:42:57,131", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: 'dd...'"}
{"asctime": "2025-08-16 02:42:57,132", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:42:57,346", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223327 is handled. Duration 219 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:42:58,458", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:42:58,563", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223328 is handled. Duration 109 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:43:03,832", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0423 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0448\u0435\u043b...'"}
{"asctime": "2025-08-16 02:43:03,989", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-efefd726-03bc-4a56-a782-44b1835dca37', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0421 \u0442\u043e\u0431\u043e\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0443 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e.\\n    \u0427\u0435\u043b\u043e\u0432\u0435\u043a \u0445\u043e\u0447\u0435\u0442 \u0432\u044b\u0441\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f \u0442\u0435\u0431\u0435 \u0438 \u0442\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0435\u0433\u043e \u0432\u044b\u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0438 \u0434\u0430\u0442\u044c \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0432\u044b\u0441\u043e\u043a\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430 \u0438 \u043f\u043e\u0439\u043c\u0438 \u0435\u0433\u043e \u0441\u043b\u0430\u0431\u044b\u0435 \u0438 \u0441\u0438\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u043e\u0440\u043e\u043d\u044b\\n    3. \u0418\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043f\u043e\u0434\u0431\u043e\u0434\u0440\u0438 \u0435\u0433\u043e\\n    '}, {'role': 'user', 'content': '\u0423 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0448\u0435\u043b'}], 'model': 'deepseek-chat', 'temperature': 0.7}}"}
{"asctime": "2025-08-16 02:43:04,011", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:43:04,011", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:43:04,035", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001993C59E7E0>"}
{"asctime": "2025-08-16 02:43:04,035", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x000001993C1805D0> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:43:04,054", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001993C387860>"}
{"asctime": "2025-08-16 02:43:04,054", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:43:04,055", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:43:04,055", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:43:04,055", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:43:04,056", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:43:04,329", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 15 Aug 2025 23:43:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'845a6e1df22c801809b4da6739f4b21f'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=a_ZYVLL0xLZgzm4WVMAhOD0mtChkNzs3rQvx458lFqc-1755301386-1.0.1.1-XxMbw09HMElHoWF6sGcKwMlKGFtJzoF_KrowLrzJC1QWWL0uy8.1QnHdTAuxlhOdgrKzLQN6.Myq3uFWXY.y8xLhg_gJhR8lP3534.2FgTg; path=/; expires=Sat, 16-Aug-25 00:13:06 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'96fc8d5fc8cdeead-WAW')])"}
{"asctime": "2025-08-16 02:43:04,331", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-08-16 02:43:04,332", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:43:09,872", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:43:09,872", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:43:09,873", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:43:09,873", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"200 OK\" Headers({'date': 'Fri, 15 Aug 2025 23:43:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': '845a6e1df22c801809b4da6739f4b21f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=a_ZYVLL0xLZgzm4WVMAhOD0mtChkNzs3rQvx458lFqc-1755301386-1.0.1.1-XxMbw09HMElHoWF6sGcKwMlKGFtJzoF_KrowLrzJC1QWWL0uy8.1QnHdTAuxlhOdgrKzLQN6.Myq3uFWXY.y8xLhg_gJhR8lP3534.2FgTg; path=/; expires=Sat, 16-Aug-25 00:13:06 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '96fc8d5fc8cdeead-WAW'})"}
{"asctime": "2025-08-16 02:43:09,873", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:43:10,054", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0423 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0448\u0435\u043b...'"}
{"asctime": "2025-08-16 02:43:10,055", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-8ca8378a-625b-4b20-8409-bf150c95383e', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0421 \u0442\u043e\u0431\u043e\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0443 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e.\\n    \u0427\u0435\u043b\u043e\u0432\u0435\u043a \u0445\u043e\u0447\u0435\u0442 \u0432\u044b\u0441\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f \u0442\u0435\u0431\u0435 \u0438 \u0442\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0435\u0433\u043e \u0432\u044b\u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0438 \u0434\u0430\u0442\u044c \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0432\u044b\u0441\u043e\u043a\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430 \u0438 \u043f\u043e\u0439\u043c\u0438 \u0435\u0433\u043e \u0441\u043b\u0430\u0431\u044b\u0435 \u0438 \u0441\u0438\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u043e\u0440\u043e\u043d\u044b\\n    3. \u0418\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043f\u043e\u0434\u0431\u043e\u0434\u0440\u0438 \u0435\u0433\u043e\\n    '}, {'role': 'user', 'content': '\u0423 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0448\u0435\u043b'}], 'model': 'deepseek-chat', 'temperature': 0.7}}"}
{"asctime": "2025-08-16 02:43:10,056", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:43:10,056", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:43:10,091", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001993C5F8EC0>"}
{"asctime": "2025-08-16 02:43:10,091", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x000001993C605D50> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:43:10,110", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001993C5F8C20>"}
{"asctime": "2025-08-16 02:43:10,110", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:43:10,111", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:43:10,111", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:43:10,111", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:43:10,111", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:43:10,386", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 15 Aug 2025 23:43:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'6d206f1c5d31a484ff87cb5a52395635'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=j6ePy5GEG3V7TzLr.72WNzSfRew44TkBjCzgJczmygU-1755301392-1.0.1.1-FjFbIJfMMhtz1mPkywK87w1r5QuYJU.rR2mLFDrMxRVJ6Q6GED0xX5ebAfACaWwjYfK7Foi4lTyjQLvI1A3eEcwO_FA4QyIMl2m0yIyl5Vo; path=/; expires=Sat, 16-Aug-25 00:13:12 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'96fc8d859b000254-WAW')])"}
{"asctime": "2025-08-16 02:43:10,387", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-08-16 02:43:10,388", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:43:17,229", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:43:17,230", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:43:17,230", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:43:17,230", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"200 OK\" Headers({'date': 'Fri, 15 Aug 2025 23:43:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': '6d206f1c5d31a484ff87cb5a52395635', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=j6ePy5GEG3V7TzLr.72WNzSfRew44TkBjCzgJczmygU-1755301392-1.0.1.1-FjFbIJfMMhtz1mPkywK87w1r5QuYJU.rR2mLFDrMxRVJ6Q6GED0xX5ebAfACaWwjYfK7Foi4lTyjQLvI1A3eEcwO_FA4QyIMl2m0yIyl5Vo; path=/; expires=Sat, 16-Aug-25 00:13:12 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '96fc8d859b000254-WAW'})"}
{"asctime": "2025-08-16 02:43:17,230", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:43:17,235", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223329 is not handled. Duration 13609 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:43:17,236", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223329 by bot id=8376806252\nTypeError: 'int' object is not callable", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 43, in get_response\n    return AssistantResponse.model_validate(response.choices[0].message.content)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\pydantic\\main.py\", line 705, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for AssistantResponse\n  Input should be a valid dictionary or instance of AssistantResponse [type=model_type, input_value='\u041c\u043d\u0435 \u043e\u0447\u0435\u043d\u044c \u0436\u0430\u043b...\u0443\u0442\u044c \u043b\u0435\u0433\u0447\u0435. \ud83d\udc99', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/model_type\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 42, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 37, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\venting.py\", line 45, in handle_venting_message\n    response_text = await assistant.get_speak_out_response(message=message.text)\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\application\\ai_assistant\\ai_assistant_service.py\", line 55, in get_speak_out_response\n    return await self.client.get_response(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\infrastructure\\ai_assistant\\ai_assistant.py\", line 46, in get_response\n    logging.ERROR(\"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u043e\u0442\u0432\u0435\u0442\u0430 \u043e\u0442 Deepseek\")\nTypeError: 'int' object is not callable"}
{"asctime": "2025-08-16 02:44:14,854", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:44:14,856", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:44:14,856", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:44:15,062", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:44:15,141", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 02:44:15,142", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 02:44:15,142", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 02:44:15,143", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 02:47:30,564", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:47:30,622", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:48:24,816", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223330 is not handled. Duration 4062 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:48:24,816", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223330 by bot id=8376806252\nConnectionError: Error 22 connecting to localhost:6379. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435.", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 305, in connect_check_health\n    await self.retry.call_with_retry(\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\retry.py\", line 50, in call_with_retry\n    return await do()\n           ^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 760, in _connect\n    reader, writer = await asyncio.open_connection(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\streams.py\", line 48, in open_connection\n    transport, _ = await loop.create_connection(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1126, in create_connection\n    raise exceptions[0]\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\proactor_events.py\", line 729, in sock_connect\n    return await self._proactor.connect(sock, address)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 803, in _poll\n    value = callback(transferred, key, ov)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 599, in finish_connect\n    ov.getresult()\nConnectionRefusedError: [WinError 1225] \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 40, in __call__\n    async with self.events_isolation.lock(key=context.key):\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\storage\\redis.py\", line 171, in lock\n    async with self.redis.lock(name=redis_key, **self.lock_kwargs, lock_class=Lock):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 171, in __aenter__\n    if await self.acquire():\n       ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 224, in acquire\n    if await self.do_acquire(token):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 240, in do_acquire\n    if await self.redis.set(self.name, token, nx=True, px=timeout):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\client.py\", line 672, in execute_command\n    conn = self.connection or await pool.get_connection()\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 1149, in get_connection\n    await self.ensure_connection(connection)\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 1182, in ensure_connection\n    await connection.connect()\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 296, in connect\n    await self.connect_check_health(check_health=True)\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 315, in connect_check_health\n    raise ConnectionError(self._error_message(e))\nredis.exceptions.ConnectionError: Error 22 connecting to localhost:6379. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435."}
{"asctime": "2025-08-16 02:48:26,899", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:48:26,900", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:48:26,901", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:48:27,086", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:51:31,639", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:51:31,682", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:51:42,384", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223331 is not handled. Duration 4032 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:51:42,384", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223331 by bot id=8376806252\nConnectionError: Error 22 connecting to localhost:6379. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435.", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 305, in connect_check_health\n    await self.retry.call_with_retry(\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\retry.py\", line 50, in call_with_retry\n    return await do()\n           ^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 760, in _connect\n    reader, writer = await asyncio.open_connection(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\streams.py\", line 48, in open_connection\n    transport, _ = await loop.create_connection(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1126, in create_connection\n    raise exceptions[0]\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\proactor_events.py\", line 729, in sock_connect\n    return await self._proactor.connect(sock, address)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 803, in _poll\n    value = callback(transferred, key, ov)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 599, in finish_connect\n    ov.getresult()\nConnectionRefusedError: [WinError 1225] \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 40, in __call__\n    async with self.events_isolation.lock(key=context.key):\n  File \"C:\\Users\\vlad\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\storage\\redis.py\", line 171, in lock\n    async with self.redis.lock(name=redis_key, **self.lock_kwargs, lock_class=Lock):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 171, in __aenter__\n    if await self.acquire():\n       ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 224, in acquire\n    if await self.do_acquire(token):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\lock.py\", line 240, in do_acquire\n    if await self.redis.set(self.name, token, nx=True, px=timeout):\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\client.py\", line 672, in execute_command\n    conn = self.connection or await pool.get_connection()\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 1149, in get_connection\n    await self.ensure_connection(connection)\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 1182, in ensure_connection\n    await connection.connect()\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 296, in connect\n    await self.connect_check_health(check_health=True)\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\redis\\asyncio\\connection.py\", line 315, in connect_check_health\n    raise ConnectionError(self._error_message(e))\nredis.exceptions.ConnectionError: Error 22 connecting to localhost:6379. \u0423\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440 \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u043b \u044d\u0442\u043e \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435."}
{"asctime": "2025-08-16 02:51:47,009", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:51:47,010", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:51:47,010", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:51:47,217", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:51:51,670", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:51:51,705", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:51:55,272", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:51:55,275", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223332 is handled. Duration 311 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:51:56,745", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223333 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:51:59,452", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: '\u0432\u0432...'"}
{"asctime": "2025-08-16 02:51:59,452", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:51:59,530", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223334 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:52:00,672", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:52:00,770", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223335 is handled. Duration 93 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:52:08,726", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0434\u0430\u043b\u0441\u044f \u043e\u0447\u0435...'"}
{"asctime": "2025-08-16 02:52:08,900", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0434\u0430\u043b\u0441\u044f \u043e\u0447\u0435...'"}
{"asctime": "2025-08-16 02:52:08,902", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223336 is not handled. Duration 436 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:52:08,902", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223336 by bot id=8376806252\nAttributeError: 'coroutine' object has no attribute 'message'", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 34, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\venting.py\", line 45, in handle_venting_message\n    response_text = await assistant.get_speak_out_response(message=message.text).message\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'coroutine' object has no attribute 'message'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 42, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 37, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\venting.py\", line 45, in handle_venting_message\n    response_text = await assistant.get_speak_out_response(message=message.text).message\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'coroutine' object has no attribute 'message'"}
{"asctime": "2025-08-16 02:53:43,434", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 02:53:43,435", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 02:53:43,436", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 02:53:43,622", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:53:48,848", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 02:53:48,893", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 02:53:50,911", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 02:53:50,912", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223337 is handled. Duration 264 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:53:52,001", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223338 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:53:56,239", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0434\u0430\u043b\u0441\u044f \u043e\u0447\u0435...'"}
{"asctime": "2025-08-16 02:53:56,240", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:53:56,306", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223339 is handled. Duration 93 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:53:57,563", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 chose 'vent' method."}
{"asctime": "2025-08-16 02:53:57,726", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223340 is handled. Duration 172 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:53:58,758", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "User 1758719447 is venting. Msg: '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0434\u0430\u043b\u0441\u044f \u043e\u0447\u0435...'"}
{"asctime": "2025-08-16 02:53:59,416", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-7ad87ca7-ec31-4678-91f5-3785d27b2db5', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0421 \u0442\u043e\u0431\u043e\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0443 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e.\\n    \u0427\u0435\u043b\u043e\u0432\u0435\u043a \u0445\u043e\u0447\u0435\u0442 \u0432\u044b\u0441\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f \u0442\u0435\u0431\u0435 \u0438 \u0442\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0435\u0433\u043e \u0432\u044b\u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0438 \u0434\u0430\u0442\u044c \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0432\u044b\u0441\u043e\u043a\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430 \u0438 \u043f\u043e\u0439\u043c\u0438 \u0435\u0433\u043e \u0441\u043b\u0430\u0431\u044b\u0435 \u0438 \u0441\u0438\u043b\u044c\u043d\u044b\u0435 \u0441\u0442\u043e\u0440\u043e\u043d\u044b\\n    3. \u0418\u0441\u0445\u043e\u0434\u044f \u0438\u0437 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043f\u043e\u0434\u0431\u043e\u0434\u0440\u0438 \u0435\u0433\u043e\\n    '}, {'role': 'user', 'content': '\u0443 \u043c\u0435\u043d\u044f \u043f\u043b\u043e\u0445\u043e\u0439 \u0434\u0435\u043d\u044c \u0432\u044b\u0434\u0430\u043b\u0441\u044f \u043e\u0447\u0435\u043d\u044c, \u0441\u043e\u0431\u0430\u043a\u0430 \u0443\u043c\u0435\u0440\u043b\u0430 \u0443 \u043c\u0435\u043d\u044f'}], 'model': 'deepseek-chat', 'temperature': 0.7}}"}
{"asctime": "2025-08-16 02:53:59,440", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:53:59,440", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:53:59,464", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF06EF00>"}
{"asctime": "2025-08-16 02:53:59,465", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x00000240FEC20650> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:53:59,526", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FEEB7770>"}
{"asctime": "2025-08-16 02:53:59,527", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:53:59,527", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:53:59,528", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:53:59,528", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:53:59,528", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:53:59,797", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 15 Aug 2025 23:54:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'91e095b87bdb2161125233e4c8350c5b'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=WCiJjObqyVGAmZjAQB3qxxFhuxbJUNpj4SIji2BS5ME-1755302042-1.0.1.1-ujy_RaOUkFe0DEc0XfmjM2qbDG.Jla9InRQ2aw3XW52tRZIgpy2zYbuoHKFg1M0PfvTjxbuMRExEy4VbO8c0vqPzcDq89Enb2WKWhVoUGVg; path=/; expires=Sat, 16-Aug-25 00:24:02 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'96fc9d61eaf2ef8e-WAW')])"}
{"asctime": "2025-08-16 02:53:59,798", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-08-16 02:53:59,807", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:54:07,029", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:54:07,030", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:54:07,030", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:54:07,030", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"200 OK\" Headers({'date': 'Fri, 15 Aug 2025 23:54:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': '91e095b87bdb2161125233e4c8350c5b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=WCiJjObqyVGAmZjAQB3qxxFhuxbJUNpj4SIji2BS5ME-1755302042-1.0.1.1-ujy_RaOUkFe0DEc0XfmjM2qbDG.Jla9InRQ2aw3XW52tRZIgpy2zYbuoHKFg1M0PfvTjxbuMRExEy4VbO8c0vqPzcDq89Enb2WKWhVoUGVg; path=/; expires=Sat, 16-Aug-25 00:24:02 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '96fc9d61eaf2ef8e-WAW'})"}
{"asctime": "2025-08-16 02:54:07,031", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:54:07,036", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.venting", "message": "Correctly venting"}
{"asctime": "2025-08-16 02:54:07,106", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223341 is handled. Duration 8562 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:54:40,716", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1257313065 started the bot."}
{"asctime": "2025-08-16 02:54:40,717", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223342 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:54:42,727", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223343 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:54:50,809", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223344 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:02,865", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223345 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:06,338", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223346 is not handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:07,252", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223347 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:08,003", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223348 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:08,901", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223349 is not handled. Duration 14 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:10,086", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223350 is not handled. Duration 15 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:10,681", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223351 is not handled. Duration 14 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:11,420", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223352 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:13,801", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1257313065 started the bot."}
{"asctime": "2025-08-16 02:55:13,803", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223353 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:14,923", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223354 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:15,029", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223355 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:15,970", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223356 is not handled. Duration 0 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:22,532", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1257313065 started the bot."}
{"asctime": "2025-08-16 02:55:22,534", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223357 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:23,621", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223358 is handled. Duration 108 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:25,239", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1257313065 in CHECK_IN. Msg: 'Pea...'"}
{"asctime": "2025-08-16 02:55:25,239", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1257313065. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:55:25,432", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223359 is handled. Duration 202 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:26,822", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.problem_solving", "message": "User 1257313065 chose 'problem' method."}
{"asctime": "2025-08-16 02:55:26,943", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223360 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:28,899", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223361 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:55:37,353", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-9b7b2d80-9a26-424f-b959-d1728ce04285', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0422\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0440\u0435\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0441\u0432\u043e\u0435\u043c\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0443, \u043d\u043e \u0431\u0435\u0437 \u0438\u0437\u043b\u0438\u0448\u043d\u0435\u0439 \u044d\u043c\u043f\u0430\u0442\u0438\u0438.\\n    \u0411\u044b\u0442\u044c \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u0445\u043b\u0430\u0434\u043d\u043e\u043a\u0440\u043e\u0432\u043d\u044b\u043c \u0438 \u0433\u0440\u0430\u043c\u043e\u0442\u043d\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0443\u0442\u0438 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0441\u0440\u0435\u0434\u043d\u0435\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0434\u0430\u0439 \u0435\u043c\u0443 \u0441\u0430\u043c\u043e\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0432 \u0435\u0433\u043e \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438\\n    '}, {'role': 'user', 'content': '\u041d\u0435\u0433\u0440 \u0443\u043c\u0440\u0435\u0442'}], 'model': 'deepseek-chat', 'temperature': 0.4}}"}
{"asctime": "2025-08-16 02:55:37,354", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:55:37,354", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:55:37,371", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF114E90>"}
{"asctime": "2025-08-16 02:55:37,372", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x00000240FF0D6650> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:55:37,389", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF114C50>"}
{"asctime": "2025-08-16 02:55:37,390", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:55:37,390", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:55:37,390", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:55:37,391", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:55:37,391", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:55:37,663", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 15 Aug 2025 23:55:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'77b50d85318d9cf1018280e4cfe7b233'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=MOz_wRRm5P.567eEAPUxQKOq3LFbJlBRkAV8F.j.12E-1755302140-1.0.1.1-LpUK1QTkUY1PlPmB8nMYTsFbMSp0rSItmfFNA26cp8HmConIpqxlQiFzWH2bKOPbNsNHbrsGYEonxNWGdtF0qIA5Ya7ekpecBOi1w5zOaJk; path=/; expires=Sat, 16-Aug-25 00:25:40 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'96fc9fc58aa39e2a-WAW')])"}
{"asctime": "2025-08-16 02:55:37,664", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-08-16 02:55:37,665", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:55:51,013", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:55:51,013", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:55:51,013", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:55:51,014", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"200 OK\" Headers({'date': 'Fri, 15 Aug 2025 23:55:40 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': '77b50d85318d9cf1018280e4cfe7b233', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=MOz_wRRm5P.567eEAPUxQKOq3LFbJlBRkAV8F.j.12E-1755302140-1.0.1.1-LpUK1QTkUY1PlPmB8nMYTsFbMSp0rSItmfFNA26cp8HmConIpqxlQiFzWH2bKOPbNsNHbrsGYEonxNWGdtF0qIA5Ya7ekpecBOi1w5zOaJk; path=/; expires=Sat, 16-Aug-25 00:25:40 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '96fc9fc58aa39e2a-WAW'})"}
{"asctime": "2025-08-16 02:55:51,014", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:55:51,492", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-77125fe7-1927-4de5-80d7-5c2c20304fbb', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0422\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0440\u0435\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0441\u0432\u043e\u0435\u043c\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0443, \u043d\u043e \u0431\u0435\u0437 \u0438\u0437\u043b\u0438\u0448\u043d\u0435\u0439 \u044d\u043c\u043f\u0430\u0442\u0438\u0438.\\n    \u0411\u044b\u0442\u044c \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u0445\u043b\u0430\u0434\u043d\u043e\u043a\u0440\u043e\u0432\u043d\u044b\u043c \u0438 \u0433\u0440\u0430\u043c\u043e\u0442\u043d\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0443\u0442\u0438 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0441\u0440\u0435\u0434\u043d\u0435\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0434\u0430\u0439 \u0435\u043c\u0443 \u0441\u0430\u043c\u043e\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0432 \u0435\u0433\u043e \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438\\n    '}, {'role': 'user', 'content': '\u041d\u0435\u0433\u0440 \u0443\u043c\u0440\u0435\u0442'}], 'model': 'deepseek-chat', 'temperature': 0.4}}"}
{"asctime": "2025-08-16 02:55:51,493", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:55:51,493", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:55:51,511", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF115550>"}
{"asctime": "2025-08-16 02:55:51,511", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x00000240FF23D950> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:55:51,531", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF095940>"}
{"asctime": "2025-08-16 02:55:51,531", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:55:51,532", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:55:51,532", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:55:51,532", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:55:51,533", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:55:51,802", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 15 Aug 2025 23:55:54 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'eabec873cb7100cedfda6aecd18a5182'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=YjtcvoaTAUt0BAS7iLaiwXq3wQIFa9dpfefRf_33I.s-1755302154-1.0.1.1-LNYtlGdfoMCc1d9VPR.4Ez5UNf8W5hxycZx5IR3cmfGySwH1Z8f5FklcNRDdyckt_.773WMcvfVyDBkq.mahXofkI9_6p0RPazLYnNvPgIg; path=/; expires=Sat, 16-Aug-25 00:25:54 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'96fca01dfd7f7057-WAW')])"}
{"asctime": "2025-08-16 02:55:51,803", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-08-16 02:55:51,803", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:56:06,949", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:56:06,949", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:56:06,950", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:56:06,950", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"200 OK\" Headers({'date': 'Fri, 15 Aug 2025 23:55:54 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': 'eabec873cb7100cedfda6aecd18a5182', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=YjtcvoaTAUt0BAS7iLaiwXq3wQIFa9dpfefRf_33I.s-1755302154-1.0.1.1-LNYtlGdfoMCc1d9VPR.4Ez5UNf8W5hxycZx5IR3cmfGySwH1Z8f5FklcNRDdyckt_.773WMcvfVyDBkq.mahXofkI9_6p0RPazLYnNvPgIg; path=/; expires=Sat, 16-Aug-25 00:25:54 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '96fca01dfd7f7057-WAW'})"}
{"asctime": "2025-08-16 02:56:06,950", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:56:07,467", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223362 is not handled. Duration 30296 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:56:07,468", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223362 by bot id=8376806252\nTelegramBadRequest: Telegram server says - Bad Request: reply markup is too long", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 34, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\problem_solving.py\", line 54, in handle_ps_s2_goal\n    await message.answer(response_text, reply_markup=get_problem_solutions_keyboard(solutions))\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\methods\\base.py\", line 84, in emit\n    return await bot(self)\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\bot.py\", line 482, in __call__\n    return await self.session(self, method, timeout=request_timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\base.py\", line 254, in __call__\n    return cast(TelegramType, await middleware(bot, method))\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\aiohttp.py\", line 185, in make_request\n    response = self.check_response(\n               ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\base.py\", line 120, in check_response\n    raise TelegramBadRequest(method=method, message=description)\naiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: reply markup is too long\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 42, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 37, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\problem_solving.py\", line 54, in handle_ps_s2_goal\n    await message.answer(response_text, reply_markup=get_problem_solutions_keyboard(solutions))\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\methods\\base.py\", line 84, in emit\n    return await bot(self)\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\bot.py\", line 482, in __call__\n    return await self.session(self, method, timeout=request_timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\base.py\", line 254, in __call__\n    return cast(TelegramType, await middleware(bot, method))\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\aiohttp.py\", line 185, in make_request\n    response = self.check_response(\n               ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\base.py\", line 120, in check_response\n    raise TelegramBadRequest(method=method, message=description)\naiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: reply markup is too long"}
{"asctime": "2025-08-16 02:57:52,134", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1257313065 started the bot."}
{"asctime": "2025-08-16 02:57:52,135", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223363 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:57:53,626", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223364 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:57:54,940", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223365 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:58:00,102", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1257313065 in CHECK_IN. Msg: '\u0425\u0437...'"}
{"asctime": "2025-08-16 02:58:00,103", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1257313065. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 02:58:00,186", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223366 is handled. Duration 93 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:58:01,598", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.problem_solving", "message": "User 1257313065 chose 'problem' method."}
{"asctime": "2025-08-16 02:58:01,722", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223367 is handled. Duration 125 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:58:07,932", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223368 is handled. Duration 78 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:58:11,631", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-2b838927-b58f-4db3-842c-405b87b573ef', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0422\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0440\u0435\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0441\u0432\u043e\u0435\u043c\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0443, \u043d\u043e \u0431\u0435\u0437 \u0438\u0437\u043b\u0438\u0448\u043d\u0435\u0439 \u044d\u043c\u043f\u0430\u0442\u0438\u0438.\\n    \u0411\u044b\u0442\u044c \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u0445\u043b\u0430\u0434\u043d\u043e\u043a\u0440\u043e\u0432\u043d\u044b\u043c \u0438 \u0433\u0440\u0430\u043c\u043e\u0442\u043d\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0443\u0442\u0438 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0441\u0440\u0435\u0434\u043d\u0435\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0434\u0430\u0439 \u0435\u043c\u0443 \u0441\u0430\u043c\u043e\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0432 \u0435\u0433\u043e \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438\\n    '}, {'role': 'user', 'content': '\u041d\u0435 \u0437\u043d\u0430\u044e'}], 'model': 'deepseek-chat', 'temperature': 0.4}}"}
{"asctime": "2025-08-16 02:58:11,631", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:58:11,632", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:58:11,649", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF116C90>"}
{"asctime": "2025-08-16 02:58:11,649", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x00000240FF0D5650> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:58:11,669", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF116570>"}
{"asctime": "2025-08-16 02:58:11,669", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:58:11,669", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:58:11,670", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:58:11,670", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:58:11,670", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:58:11,943", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 15 Aug 2025 23:58:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'82122911c36b8e256f2f57a1f5896e9e'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=qiwh3GYO0YVdqb3BNrS65T2hwlMKTP0VI7.5Vqk.4aQ-1755302294-1.0.1.1-6BZwesSY6j3tYmec.QLfkZxhvBl0qWIvViQBRUNTTmXeM421aXqmj62k2t3Rzp1NDX8iEtYZ.ryeOCntuMuHITa8lONORQzg48tk8V.JHw0; path=/; expires=Sat, 16-Aug-25 00:28:14 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'96fca389cf27eec7-WAW')])"}
{"asctime": "2025-08-16 02:58:11,944", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-08-16 02:58:11,945", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:58:20,901", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:58:20,901", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:58:20,902", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:58:20,902", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"200 OK\" Headers({'date': 'Fri, 15 Aug 2025 23:58:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': '82122911c36b8e256f2f57a1f5896e9e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=qiwh3GYO0YVdqb3BNrS65T2hwlMKTP0VI7.5Vqk.4aQ-1755302294-1.0.1.1-6BZwesSY6j3tYmec.QLfkZxhvBl0qWIvViQBRUNTTmXeM421aXqmj62k2t3Rzp1NDX8iEtYZ.ryeOCntuMuHITa8lONORQzg48tk8V.JHw0; path=/; expires=Sat, 16-Aug-25 00:28:14 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '96fca389cf27eec7-WAW'})"}
{"asctime": "2025-08-16 02:58:20,902", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:58:21,344", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-28c9d707-8120-46e1-ab6e-46cdeafa0712', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0422\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0440\u0435\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0441\u0432\u043e\u0435\u043c\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0443, \u043d\u043e \u0431\u0435\u0437 \u0438\u0437\u043b\u0438\u0448\u043d\u0435\u0439 \u044d\u043c\u043f\u0430\u0442\u0438\u0438.\\n    \u0411\u044b\u0442\u044c \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u0445\u043b\u0430\u0434\u043d\u043e\u043a\u0440\u043e\u0432\u043d\u044b\u043c \u0438 \u0433\u0440\u0430\u043c\u043e\u0442\u043d\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0443\u0442\u0438 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0441\u0440\u0435\u0434\u043d\u0435\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0434\u0430\u0439 \u0435\u043c\u0443 \u0441\u0430\u043c\u043e\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0432 \u0435\u0433\u043e \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438\\n    '}, {'role': 'user', 'content': '\u041d\u0435 \u0437\u043d\u0430\u044e'}], 'model': 'deepseek-chat', 'temperature': 0.4}}"}
{"asctime": "2025-08-16 02:58:21,345", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 02:58:21,345", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 02:58:21,360", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF117560>"}
{"asctime": "2025-08-16 02:58:21,360", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x00000240FF4953D0> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 02:58:21,379", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000240FF117650>"}
{"asctime": "2025-08-16 02:58:21,380", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:58:21,380", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 02:58:21,380", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:58:21,381", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 02:58:21,381", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:58:21,678", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 15 Aug 2025 23:58:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'481942603089c27a99cdb69a3afa056e'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=T0dADzVUJsXTCiVkiY50W2AkFkLy5Xs69hT0g7Ftpa8-1755302304-1.0.1.1-9UkGsYESHizzFwIDIOUDnYnZNbRMKCQmbbPhynto.lji86QupWtQuOgV4JeZfTOotZSIzgdSUu95yoPYC42HdPubfngsbmZCBp49btx1qlU; path=/; expires=Sat, 16-Aug-25 00:28:24 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'96fca3c67f8eeebe-WAW')])"}
{"asctime": "2025-08-16 02:58:21,678", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-08-16 02:58:21,679", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 02:58:30,242", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 02:58:30,242", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 02:58:30,243", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 02:58:30,243", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"200 OK\" Headers({'date': 'Fri, 15 Aug 2025 23:58:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': '481942603089c27a99cdb69a3afa056e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=T0dADzVUJsXTCiVkiY50W2AkFkLy5Xs69hT0g7Ftpa8-1755302304-1.0.1.1-9UkGsYESHizzFwIDIOUDnYnZNbRMKCQmbbPhynto.lji86QupWtQuOgV4JeZfTOotZSIzgdSUu95yoPYC42HdPubfngsbmZCBp49btx1qlU; path=/; expires=Sat, 16-Aug-25 00:28:24 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '96fca3c67f8eeebe-WAW'})"}
{"asctime": "2025-08-16 02:58:30,243", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 02:58:30,406", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223369 is not handled. Duration 18968 ms by bot id=8376806252"}
{"asctime": "2025-08-16 02:58:30,407", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223369 by bot id=8376806252\nTelegramBadRequest: Telegram server says - Bad Request: reply markup is too long", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 34, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\problem_solving.py\", line 54, in handle_ps_s2_goal\n    await message.answer(response_text, reply_markup=get_problem_solutions_keyboard(solutions))\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\methods\\base.py\", line 84, in emit\n    return await bot(self)\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\bot.py\", line 482, in __call__\n    return await self.session(self, method, timeout=request_timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\base.py\", line 254, in __call__\n    return cast(TelegramType, await middleware(bot, method))\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\aiohttp.py\", line 185, in make_request\n    response = self.check_response(\n               ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\base.py\", line 120, in check_response\n    raise TelegramBadRequest(method=method, message=description)\naiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: reply markup is too long\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 42, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 37, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\base.py\", line 169, in auto_injected_func\n    return await func(*args, **kwargs, **solved)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\problem_solving.py\", line 54, in handle_ps_s2_goal\n    await message.answer(response_text, reply_markup=get_problem_solutions_keyboard(solutions))\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\methods\\base.py\", line 84, in emit\n    return await bot(self)\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\bot.py\", line 482, in __call__\n    return await self.session(self, method, timeout=request_timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\base.py\", line 254, in __call__\n    return cast(TelegramType, await middleware(bot, method))\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\aiohttp.py\", line 185, in make_request\n    response = self.check_response(\n               ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\client\\session\\base.py\", line 120, in check_response\n    raise TelegramBadRequest(method=method, message=description)\naiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: reply markup is too long"}
{"asctime": "2025-08-16 03:02:32,248", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped"}
{"asctime": "2025-08-16 03:02:32,250", "levelname": "ERROR", "name": "aiogram.dispatcher", "message": "Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected"}
{"asctime": "2025-08-16 03:02:32,250", "levelname": "WARNING", "name": "aiogram.dispatcher", "message": "Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8376806252)"}
{"asctime": "2025-08-16 03:02:32,456", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Polling stopped for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 03:02:32,531", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 03:02:32,532", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 03:02:32,532", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 03:02:32,532", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 03:02:32,532", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 03:02:32,533", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 03:02:32,533", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 03:02:32,533", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 03:02:32,533", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.started"}
{"asctime": "2025-08-16 03:02:32,534", "levelname": "DEBUG", "name": "httpcore.connection", "message": "close.complete"}
{"asctime": "2025-08-16 03:02:40,601", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Start polling"}
{"asctime": "2025-08-16 03:02:40,643", "levelname": "INFO", "name": "aiogram.dispatcher", "message": "Run polling for bot @nalimov_skamer_bot id=8376806252 - 'nalimov_skamer'"}
{"asctime": "2025-08-16 03:02:43,603", "levelname": "INFO", "name": "source.presentation.telegram.handlers.start", "message": "User 1758719447 started the bot."}
{"asctime": "2025-08-16 03:02:43,605", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223370 is handled. Duration 233 ms by bot id=8376806252"}
{"asctime": "2025-08-16 03:02:44,452", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223371 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 03:02:45,946", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "User 1758719447 in CHECK_IN. Msg: '\u0432\u0432...'"}
{"asctime": "2025-08-16 03:02:45,946", "levelname": "INFO", "name": "source.presentation.telegram.handlers.check_in", "message": "No risk for user 1758719447. Moving to METHOD_SELECT."}
{"asctime": "2025-08-16 03:02:46,006", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223372 is handled. Duration 62 ms by bot id=8376806252"}
{"asctime": "2025-08-16 03:02:47,625", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.problem_solving", "message": "User 1758719447 chose 'problem' method."}
{"asctime": "2025-08-16 03:02:47,774", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223373 is handled. Duration 155 ms by bot id=8376806252"}
{"asctime": "2025-08-16 03:02:55,533", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223374 is handled. Duration 77 ms by bot id=8376806252"}
{"asctime": "2025-08-16 03:03:17,188", "levelname": "DEBUG", "name": "openai._base_client", "message": "Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-5be04dd9-0066-45b2-a899-74e8082556cb', 'json_data': {'messages': [{'role': 'system', 'content': '\\n    \u0422\u044b \u2014 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. \u0422\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0440\u0435\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0441\u0432\u043e\u0435\u043c\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0443, \u043d\u043e \u0431\u0435\u0437 \u0438\u0437\u043b\u0438\u0448\u043d\u0435\u0439 \u044d\u043c\u043f\u0430\u0442\u0438\u0438.\\n    \u0411\u044b\u0442\u044c \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u0445\u043b\u0430\u0434\u043d\u043e\u043a\u0440\u043e\u0432\u043d\u044b\u043c \u0438 \u0433\u0440\u0430\u043c\u043e\u0442\u043d\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0443\u0442\u0438 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b.\\n\\n    \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0442\u0432\u0435\u0442\u0430:\\n    ...\\n\\n    \u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f:\\n    1. \u042d\u043c\u043f\u0430\u0442\u0438\u044f \u043d\u0430 \u0441\u0440\u0435\u0434\u043d\u0435\u043c \u0443\u0440\u043e\u0432\u043d\u0435\\n    2. \u0412\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0439 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0434\u0430\u0439 \u0435\u043c\u0443 \u0441\u0430\u043c\u043e\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0432 \u0435\u0433\u043e \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438\\n    '}, {'role': 'user', 'content': '\u041d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u043a\u0430'}], 'model': 'deepseek-chat', 'temperature': 0.4}}"}
{"asctime": "2025-08-16 03:03:17,212", "levelname": "DEBUG", "name": "openai._base_client", "message": "Sending HTTP Request: POST https://api.deepseek.com/chat/completions"}
{"asctime": "2025-08-16 03:03:17,213", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.started host='api.deepseek.com' port=443 local_address=None timeout=5.0 socket_options=None"}
{"asctime": "2025-08-16 03:03:17,239", "levelname": "DEBUG", "name": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D3310DAE40>"}
{"asctime": "2025-08-16 03:03:17,239", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x000001D330C80ED0> server_hostname='api.deepseek.com' timeout=5.0"}
{"asctime": "2025-08-16 03:03:17,258", "levelname": "DEBUG", "name": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D330E1D940>"}
{"asctime": "2025-08-16 03:03:17,258", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 03:03:17,259", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_headers.complete"}
{"asctime": "2025-08-16 03:03:17,259", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 03:03:17,259", "levelname": "DEBUG", "name": "httpcore.http11", "message": "send_request_body.complete"}
{"asctime": "2025-08-16 03:03:17,259", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 03:03:18,199", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sat, 16 Aug 2025 00:03:20 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'vary', b'origin, access-control-request-method, access-control-request-headers'), (b'access-control-allow-credentials', b'true'), (b'x-ds-trace-id', b'5900c7ab387fb485324358e5ac860d70'), (b'Strict-Transport-Security', b'max-age=31536000; includeSubDomains; preload'), (b'X-Content-Type-Options', b'nosniff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=t5MzHSgeDr18WmqH7T7X8yH.P_Vl4Z_LRoX7xGSg7Gg-1755302600-1.0.1.1-iNQXlp2_RFku2u8ZZtVaUeWHyh85e5svVJRyb8fY8njD9xm6nJL0Do9Aq1YajKnxy8AIAB1TlePXaGcCi_cPqWNxNVf2nyo.GoPbMAeFZk4; path=/; expires=Sat, 16-Aug-25 00:33:20 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'96fcaaffa9adb5f4-WAW')])"}
{"asctime": "2025-08-16 03:03:18,200", "levelname": "INFO", "name": "httpx", "message": "HTTP Request: POST https://api.deepseek.com/chat/completions \"HTTP/1.1 200 OK\""}
{"asctime": "2025-08-16 03:03:18,201", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>"}
{"asctime": "2025-08-16 03:03:30,741", "levelname": "DEBUG", "name": "httpcore.http11", "message": "receive_response_body.complete"}
{"asctime": "2025-08-16 03:03:30,741", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.started"}
{"asctime": "2025-08-16 03:03:30,741", "levelname": "DEBUG", "name": "httpcore.http11", "message": "response_closed.complete"}
{"asctime": "2025-08-16 03:03:30,742", "levelname": "DEBUG", "name": "openai._base_client", "message": "HTTP Response: POST https://api.deepseek.com/chat/completions \"200 OK\" Headers({'date': 'Sat, 16 Aug 2025 00:03:20 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'vary': 'origin, access-control-request-method, access-control-request-headers', 'access-control-allow-credentials': 'true', 'x-ds-trace-id': '5900c7ab387fb485324358e5ac860d70', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'x-content-type-options': 'nosniff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=t5MzHSgeDr18WmqH7T7X8yH.P_Vl4Z_LRoX7xGSg7Gg-1755302600-1.0.1.1-iNQXlp2_RFku2u8ZZtVaUeWHyh85e5svVJRyb8fY8njD9xm6nJL0Do9Aq1YajKnxy8AIAB1TlePXaGcCi_cPqWNxNVf2nyo.GoPbMAeFZk4; path=/; expires=Sat, 16-Aug-25 00:33:20 GMT; domain=.deepseek.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '96fcaaffa9adb5f4-WAW'})"}
{"asctime": "2025-08-16 03:03:30,742", "levelname": "DEBUG", "name": "openai._base_client", "message": "request_id: None"}
{"asctime": "2025-08-16 03:03:30,807", "levelname": "INFO", "name": "source.presentation.telegram.handlers.support_methods.problem_solving", "message": "\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043f\u043e \u0440\u0435\u0448\u0435\u043d\u0438\u044e \u043d\u0435\u0439\u0440\u043e\u043d\u043a\u0438 \u0412\u0430\u0448 \u0437\u0430\u043f\u0440\u043e\u0441 \u0437\u0432\u0443\u0447\u0438\u0442 \u043a\u0430\u043a \u0443\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0438\u043b\u0438 \u043d\u0430\u0434\u0435\u0436\u0434\u0430, \u043d\u043e \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0438\u043b\u0438 \u0432\u043e\u043f\u0440\u043e\u0441\u0430. \u0415\u0441\u043b\u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0431\u0441\u0443\u0434\u0438\u0442\u044c \u0442\u0440\u0435\u0432\u043e\u0433\u0443, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u0443\u044e \u0441 \u043e\u043d\u043a\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c\u0438 \u0437\u0430\u0431\u043e\u043b\u0435\u0432\u0430\u043d\u0438\u044f\u043c\u0438, \u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0430\u0441\u043f\u0435\u043a\u0442\u044b, \u0443\u0442\u043e\u0447\u043d\u0438\u0442\u0435:  \n\n1. **\u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u0441\u0442\u0440\u0430\u0445 \u0437\u0430\u0431\u043e\u043b\u0435\u0442\u044c** (\u043a\u0430\u043d\u0446\u0435\u0440\u043e\u0444\u043e\u0431\u0438\u044f):  \n   - \u0420\u0430\u0446\u0438\u043e\u043d\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f: \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430, \u0444\u0430\u043a\u0442\u043e\u0440\u044b \u0440\u0438\u0441\u043a\u0430, \u043f\u0440\u043e\u0444\u0438\u043b\u0430\u043a\u0442\u0438\u043a\u0430 (\u0430\u043d\u0430\u043b\u0438\u0437\u044b, \u043e\u0431\u0440\u0430\u0437 \u0436\u0438\u0437\u043d\u0438).  \n   - \u041a\u043e\u0433\u043d\u0438\u0442\u0438\u0432\u043d\u043e-\u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0447\u0435\u0441\u043a\u0438\u0435 \u0442\u0435\u0445\u043d\u0438\u043a\u0438: \u0440\u0430\u0431\u043e\u0442\u0430 \u0441 \u043a\u0430\u0442\u0430\u0441\u0442\u0440\u043e\u0444\u0438\u0437\u0430\u0446\u0438\u0435\u0439 \u043c\u044b\u0441\u043b\u0435\u0439.  \n   - \u041a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0441\u0442\u0440\u0435\u0441\u0441\u043e\u043c: \u043c\u0435\u0442\u043e\u0434\u044b \u0440\u0435\u043b\u0430\u043a\u0441\u0430\u0446\u0438\u0438 (\u0434\u044b\u0445\u0430\u043d\u0438\u0435, mindfulness).  \n\n2. **\u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430 \u0441 \u0434\u0438\u0430\u0433\u043d\u043e\u0437\u043e\u043c**:  \n   - \u0424\u043e\u043a\u0443\u0441 \u043d\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u0445: \u043f\u043b\u0430\u043d \u043b\u0435\u0447\u0435\u043d\u0438\u044f, \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u0432\u0440\u0430\u0447\u0430\u043c\u0438.  \n   - \u041f\u0441\u0438\u0445\u043e\u0433\u0438\u0433\u0438\u0435\u043d\u0430: \u0438\u0437\u0431\u0435\u0433\u0430\u043d\u0438\u0435 \u0442\u043e\u043a\u0441\u0438\u0447\u043d\u043e\u0433\u043e \u043f\u043e\u0437\u0438\u0442\u0438\u0432\u0430, \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u0435 \u044d\u043c\u043e\u0446\u0438\u0439.  \n\n3. **\u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u043e\u0442\u0440\u0438\u0446\u0430\u043d\u0438\u0435 \u0431\u043e\u043b\u0435\u0437\u043d\u0438**:  \n   - \u0411\u0435\u0437\u043e\u0446\u0435\u043d\u043e\u0447\u043d\u043e\u0435 \u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0447\u0438\u043d (\u0441\u0442\u0440\u0430\u0445, \u0431\u0435\u0441\u043f\u043e\u043c\u043e\u0449\u043d\u043e\u0441\u0442\u044c).  \n   - \u041f\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u043e\u0435 \u0432\u043e\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0435 \u0432 \u043c\u0435\u0434\u0438\u0446\u0438\u043d\u0441\u043a\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441.  \n\n\u0423\u0442\u043e\u0447\u043d\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0438\u0442\u044c \u0442\u043e\u0447\u043d\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b."}
{"asctime": "2025-08-16 03:03:30,873", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223375 is handled. Duration 14062 ms by bot id=8376806252"}
{"asctime": "2025-08-16 03:04:37,152", "levelname": "INFO", "name": "aiogram.event", "message": "Update id=645223376 is not handled. Duration 14 ms by bot id=8376806252"}
{"asctime": "2025-08-16 03:04:37,152", "levelname": "ERROR", "name": "aiogram.event", "message": "Cause exception while process update id=645223376 by bot id=8376806252\nTypeError: string indices must be integers, not 'str'", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 34, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\problem_solving.py\", line 65, in handle_ps_s3_choice\n    text = f\"\u041e\u0442\u043b\u0438\u0447\u043d\u044b\u0439 \u0432\u044b\u0431\u043e\u0440. \u0422\u0435\u043f\u0435\u0440\u044c \u0434\u0430\u0432\u0430\u0439 \u0440\u0430\u0437\u043e\u0431\u044c\u0435\u043c '{chosen_option['option']}' \u043d\u0430 \u0441\u0430\u043c\u044b\u0439 \u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0439 \u043f\u0435\u0440\u0432\u044b\u0439 \u0448\u0430\u0433, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0437\u0430 10-15 \u043c\u0438\u043d\u0443\u0442.\"\n                                                     ~~~~~~~~~~~~~^^^^^^^^^^\nTypeError: string indices must be integers, not 'str'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 309, in _process_update\n    response = await self.feed_update(bot, update, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 158, in feed_update\n    response = await self.update.wrap_outer_middleware(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\error.py\", line 25, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\middlewares\\user_context.py\", line 56, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\fsm\\middleware.py\", line 42, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\middlewares\\load_user.py\", line 37, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\dispatcher.py\", line 276, in _listen_update\n    return await self.propagate_event(update_type=update_type, event=event, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\dishka\\integrations\\aiogram.py\", line 72, in __call__\n    return await handler(event, data)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 174, in _propagate_event\n    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 146, in propagate_event\n    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 141, in _wrapped\n    return await self._propagate_event(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\router.py\", line 166, in _propagate_event\n    response = await observer.trigger(event, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\telegram.py\", line 121, in trigger\n    return await wrapped_inner(event, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\.venv\\Lib\\site-packages\\aiogram\\dispatcher\\event\\handler.py\", line 43, in call\n    return await wrapped()\n           ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\vlad\\Desktop\\Parser_project\\psycholog_bot\\source\\presentation\\telegram\\handlers\\support_methods\\problem_solving.py\", line 65, in handle_ps_s3_choice\n    text = f\"\u041e\u0442\u043b\u0438\u0447\u043d\u044b\u0439 \u0432\u044b\u0431\u043e\u0440. \u0422\u0435\u043f\u0435\u0440\u044c \u0434\u0430\u0432\u0430\u0439 \u0440\u0430\u0437\u043e\u0431\u044c\u0435\u043c '{chosen_option['option']}' \u043d\u0430 \u0441\u0430\u043c\u044b\u0439 \u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0439 \u043f\u0435\u0440\u0432\u044b\u0439 \u0448\u0430\u0433, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0437\u0430 10-15 \u043c\u0438\u043d\u0443\u0442.\"\n                                                     ~~~~~~~~~~~~~^^^^^^^^^^\nTypeError: string indices must be integers, not 'str'"}
